<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Grade 12 Physical Science Portal</title>

<style>
body {
  font-family: Arial;
  background:#f4f6f9;
  text-align:center;
}
input, button {
  padding:10px;
  margin:5px;
  width:250px;
}
button {
  background:#06b6d4;
  border:none;
  color:white;
  cursor:pointer;
}
#login-step2, #content {
  display:none;
}
iframe {
  width:90%;
  height:600px;
  border:none;
  margin-top:20px;
}
</style>

<script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
<script>
emailjs.init("_6kozn-J9-QGCchMe");
</script>

</head>
<body>

<h1>Physical Science Portal</h1>

<!-- LOGIN / SIGNUP -->
<div id="login-step1">
<h2>Sign Up / Log In</h2>

<input type="email" id="email" placeholder="Email"><br>
<input type="password" id="password" placeholder="Password"><br>

<button onclick="signUp()">Sign Up</button>
<button onclick="logIn()">Log In</button>

<p id="error"></p>
</div>

<!-- CODE VERIFICATION -->
<div id="login-step2">
<h2>Enter Access Code</h2>

<input type="text" id="code" placeholder="Enter Code"><br>

<button id="sendBtn" onclick="sendCode()">Send Code</button>
<button onclick="verifyCode()">Verify Code</button>

<p id="timer"></p>
<p id="codeError"></p>
</div>

<!-- CONTENT -->
<div id="content">
<h2>Physics Paper 1</h2>
<iframe src="physics-paper1.pdf"></iframe>

<h2>Chemistry Paper 2</h2>
<iframe src="chemistry-paper2.pdf"></iframe>
</div>

<script>

let users = JSON.parse(localStorage.getItem("users") || "[]");
let currentCode = "";
let cooldown = false;

// SIGN UP
function signUp(){
let email = document.getElementById("email").value;
let password = document.getElementById("password").value;

if(!email || !password){
document.getElementById("error").innerText="Fill all fields";
return;
}

if(users.find(u=>u.email===email)){
document.getElementById("error").innerText="Email already exists";
return;
}

localStorage.setItem("tempUser", JSON.stringify({email,password}));

document.getElementById("login-step1").style.display="none";
document.getElementById("login-step2").style.display="block";
}

// LOGIN
function logIn(){
let email = document.getElementById("email").value;
let password = document.getElementById("password").value;

let user = users.find(u=>u.email===email && u.password===password);

if(user){
document.getElementById("login-step1").style.display="none";
document.getElementById("content").style.display="block";
}else{
document.getElementById("error").innerText="Incorrect login";
}
}

// GENERATE CODE
function generateCode(){
let chars="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%";
let code="";
for(let i=0;i<8;i++){
code+=chars[Math.floor(Math.random()*chars.length)];
}
return code;
}

// SEND CODE
function sendCode(){
if(cooldown) return;

let tempUser = JSON.parse(localStorage.getItem("tempUser"));
if(!tempUser) return;

currentCode = generateCode();
localStorage.setItem("tempCode", currentCode);

emailjs.send("service_ah9oypr","template_0qg4mop",{
to_email: tempUser.email,
code: currentCode
})
.then(()=> alert("Code sent to email"))
.catch(()=> alert("Email failed but code shown"));

alert("Your code: "+currentCode);

startTimer();
}

// TIMER
function startTimer(){
cooldown=true;
let time=180;
let timer=document.getElementById("timer");

let interval=setInterval(()=>{
timer.innerText="Resend in "+time+"s";
time--;

if(time<0){
clearInterval(interval);
cooldown=false;
timer.innerText="";
}
},1000);
}

// VERIFY CODE
function verifyCode(){
let input=document.getElementById("code").value;
let saved=localStorage.getItem("tempCode");
let tempUser=JSON.parse(localStorage.getItem("tempUser"));

if(input===saved){
users.push(tempUser);
localStorage.setItem("users", JSON.stringify(users));

document.getElementById("login-step2").style.display="none";
document.getElementById("content").style.display="block";

}else{
document.getElementById("codeError").innerText="Wrong code";
}
}

</script>

</body>
</html>








